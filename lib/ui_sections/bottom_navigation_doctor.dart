import 'package:active_ecommerce_flutter/screens/doctorScreens/doctor_notification.dart';
import 'package:active_ecommerce_flutter/screens/new_doctor_screens/all_chat_list.dart';
import 'package:flutter/material.dart';
import 'package:flutter_hex_color/flutter_hex_color.dart';
import 'package:flutter_svg/flutter_svg.dart';
import 'package:active_ecommerce_flutter/screens/new_doctor_screens/Profile1.dart';
import 'package:active_ecommerce_flutter/screens/new_doctor_screens/doctor_appointments.dart';
import 'package:active_ecommerce_flutter/screens/new_doctor_screens/Home1.dart';
import 'package:active_ecommerce_flutter/screens/patientScreens/ChatRoom.dart';
import 'package:active_ecommerce_flutter/screens/patientScreens/chat_page.dart';
import 'package:flutter/material.dart';
import 'package:active_ecommerce_flutter/my_theme.dart';
import 'package:custom_horizontal_calendar/custom_horizontal_calendar.dart';
import 'package:custom_horizontal_calendar/date_row.dart';
import 'package:flutter_svg/flutter_svg.dart';
import 'package:adobe_xd/pinned.dart';
import 'package:active_ecommerce_flutter/Message.dart';
import 'package:active_ecommerce_flutter/models/doctor_list.dart';
import 'package:active_ecommerce_flutter/helpers/shared_value_helper.dart';
import 'package:http/http.dart' as http;
import 'dart:async';
import 'package:active_ecommerce_flutter/data_handler/doctors_data_fetch.dart';
import 'dart:convert';
import 'package:flutter/services.dart';
import 'package:active_ecommerce_flutter/app_config.dart';

class BottomBar2 extends StatefulWidget {
  @override
  BottomBar2State createState() => BottomBar2State();
}

class BottomBar2State extends State<BottomBar2> {
  int pageIndex = 0;
  final pages = [
    Home1(),
    PatientsList(
      is_base_category: true,
    ),
    DoctorChats(
      is_base_category: true,
    ),
    DoctorProfileEdit(
      is_base_category: true,
    ),
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: const Color(0xffC4DFCB),
      body: pages[pageIndex],
      bottomNavigationBar: buildMyNavBar(context),
    );
  }

  Container buildMyNavBar(BuildContext context) {
    return Container(
      height: 60,
      decoration: BoxDecoration(
        color: Colors.white,
      ),
      child: Row(
        mainAxisAlignment: MainAxisAlignment.spaceAround,
        children: [
          GestureDetector(
            onTap: () {
              setState(() {
                pageIndex = 0;
              });
            },
            child: Container(
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  Container(
                    height: 25,
                    width: 25,
                    child: SvgPicture.string(
                      '<svg viewBox="3.0 2.0 17.0 17.0" ><path transform="translate(0.0, 0.0)" d="M 11.45956230163574 1.972659945487976 C 11.27451324462891 1.972659945487976 11.09786319732666 2.045559406280518 10.9660758972168 2.174540042877197 L 3.238526344299316 8.494503974914551 C 3.230113744735718 8.500102043151855 3.221701145172119 8.508501052856445 3.2132887840271 8.514100074768066 L 3.188050746917725 8.536566734313965 L 3.188050746917725 8.539365768432617 C 3.045058250427246 8.671152114868164 2.960939645767212 8.861800193786621 2.960939645767212 9.05811595916748 C 2.960939645767212 9.447807312011719 3.277775526046753 9.764642715454102 3.670324563980103 9.764642715454102 L 4.376903533935547 9.764642715454102 L 4.376903533935547 17.55666542053223 C 4.376903533935547 18.33891868591309 5.010589599609375 18.97266006469727 5.792873859405518 18.97266006469727 L 17.12901306152344 18.97266006469727 C 17.91134071350098 18.97266006469727 18.54501152038574 18.33891868591309 18.54501152038574 17.55666542053223 L 18.54501152038574 9.764642715454102 L 19.25161170959473 9.764642715454102 C 19.64410209655762 9.764642715454102 19.96093940734863 9.447807312011719 19.96093940734863 9.05811595916748 C 19.96093940734863 8.861800193786621 19.87968254089355 8.671152114868164 19.73662948608398 8.536566734313965 L 19.72542953491211 8.528168678283691 C 19.70863342285156 8.514100074768066 19.6917667388916 8.502902030944824 19.67496681213379 8.48890495300293 L 18.54501152038574 7.563608646392822 L 18.54501152038574 4.807390689849854 C 18.54501152038574 4.417649745941162 18.22537612915039 4.098001003265381 17.83561325073242 4.098001003265381 L 17.12901306152344 4.098001003265381 C 16.73644828796387 4.098001003265381 16.41961288452148 4.417649745941162 16.41961288452148 4.807390689849854 L 16.41961288452148 5.825195789337158 L 11.93904972076416 2.160521507263184 C 11.81006145477295 2.042752742767334 11.63901138305664 1.972659945487976 11.45956230163574 1.972659945487976 Z M 13.58488750457764 11.18063735961914 L 16.41961288452148 11.18063735961914 L 16.41961288452148 16.85006904602051 L 13.58488750457764 16.85006904602051 L 13.58488750457764 11.18063735961914 Z" fill="#6b0772" stroke="none" stroke-width="1" stroke-miterlimit="4" stroke-linecap="butt" /></svg>',
                      allowDrawingOutsideViewBox: true,
                      fit: BoxFit.fill,
                      color: pageIndex == 0 ? HexColor('33BEA3') : Colors.grey,
                    ),
                  ),
                  Padding(
                    padding: const EdgeInsets.all(3.0),
                    child: Text(
                      'Home',
                      style: TextStyle(
                        fontFamily: 'Arial',
                        fontSize: 10,
                        color:
                            pageIndex == 0 ? HexColor('33BEA3') : Colors.grey,
                      ),
                      textAlign: TextAlign.left,
                    ),
                  )
                ],
              ),
            ),
          ),
          // Adobe XD layer: 'surface1' (group)
          GestureDetector(
            onTap: () {
              setState(() {
                pageIndex = 1;
              });
            },
            child: Container(
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  Container(
                    height: 25,
                    width: 25,
                    child: SvgPicture.string(
                      '<svg viewBox="3.9 3.9 17.0 17.0" ><path  d="M 5.256316184997559 3.949219942092896 C 4.534174919128418 3.949219942092896 3.949219942092896 4.534174919128418 3.949219942092896 5.256316184997559 L 3.949219942092896 17.02533531188965 C 3.949219942092896 17.7474422454834 4.534174919128418 18.33245849609375 5.256316184997559 18.33245849609375 L 12.24476718902588 18.33245849609375 C 12.98238086700439 19.87507057189941 14.55348491668701 20.94922065734863 16.3730640411377 20.94922065734863 C 18.89408302307129 20.94922065734863 20.94922065734863 18.89408302307129 20.94922065734863 16.3730640411377 C 20.94922065734863 14.55348491668701 19.87507057189941 12.98238086700439 18.33245849609375 12.24476718902588 L 18.33245849609375 5.256316184997559 C 18.33245849609375 4.534174919128418 17.7474422454834 3.949219942092896 17.02533531188965 3.949219942092896 L 5.256316184997559 3.949219942092896 Z M 5.256316184997559 5.256316184997559 L 17.02533531188965 5.256316184997559 L 17.02533531188965 7.870501518249512 L 5.256316184997559 7.870501518249512 L 5.256316184997559 5.256316184997559 Z M 8.525362014770508 9.832418441772461 C 8.885090827941895 9.832418441772461 9.180214881896973 10.12747669219971 9.180214881896973 10.48727130889893 C 9.180214881896973 10.84706687927246 8.885090827941895 11.13954067230225 8.525362014770508 11.13954067230225 C 8.165566444396973 11.13954067230225 7.870501518249512 10.84706687927246 7.870501518249512 10.48727130889893 C 7.870501518249512 10.12747669219971 8.165566444396973 9.832418441772461 8.525362014770508 9.832418441772461 Z M 11.13954067230225 9.832418441772461 C 11.50191974639893 9.832418441772461 11.79439449310303 10.12747669219971 11.79439449310303 10.48727130889893 C 11.79439449310303 10.84706687927246 11.50191974639893 11.13954067230225 11.13954067230225 11.13954067230225 C 10.77974605560303 11.13954067230225 10.48727130889893 10.84706687927246 10.48727130889893 10.48727130889893 C 10.48727130889893 10.12747669219971 10.77974605560303 9.832418441772461 11.13954067230225 9.832418441772461 Z M 13.75630378723145 9.832418441772461 C 14.11609840393066 9.832418441772461 14.41115760803223 10.12747669219971 14.41115760803223 10.48727130889893 C 14.41115760803223 10.84706687927246 14.11609840393066 11.13954067230225 13.75630378723145 11.13954067230225 C 13.39650917053223 11.13954067230225 13.10145092010498 10.84706687927246 13.10145092010498 10.48727130889893 C 13.10145092010498 10.12747669219971 13.39650917053223 9.832418441772461 13.75630378723145 9.832418441772461 Z M 16.3730640411377 9.832418441772461 C 16.73286056518555 9.832418441772461 17.02533531188965 10.12747669219971 17.02533531188965 10.48727130889893 C 17.02533531188965 10.84706687927246 16.73286056518555 11.13954067230225 16.3730640411377 11.13954067230225 C 16.01068687438965 11.13954067230225 15.71821308135986 10.84706687927246 15.71821308135986 10.48727130889893 C 15.71821308135986 10.12747669219971 16.01068687438965 9.832418441772461 16.3730640411377 9.832418441772461 Z M 5.908565521240234 12.44918155670166 C 6.270931243896484 12.44918155670166 6.563405513763428 12.74172210693359 6.563405513763428 13.10145092010498 C 6.563405513763428 13.46382904052734 6.270931243896484 13.75630378723145 5.908565521240234 13.75630378723145 C 5.548790454864502 13.75630378723145 5.256316184997559 13.46382904052734 5.256316184997559 13.10145092010498 C 5.256316184997559 12.74172210693359 5.548790454864502 12.44918155670166 5.908565521240234 12.44918155670166 Z M 8.525362014770508 12.44918155670166 C 8.885090827941895 12.44918155670166 9.180214881896973 12.74172210693359 9.180214881896973 13.10145092010498 C 9.180214881896973 13.46382904052734 8.885090827941895 13.75630378723145 8.525362014770508 13.75630378723145 C 8.165566444396973 13.75630378723145 7.870501518249512 13.46382904052734 7.870501518249512 13.10145092010498 C 7.870501518249512 12.74172210693359 8.165566444396973 12.44918155670166 8.525362014770508 12.44918155670166 Z M 11.13954067230225 12.44918155670166 C 11.50191974639893 12.44918155670166 11.79439449310303 12.74172210693359 11.79439449310303 13.10145092010498 C 11.79439449310303 13.46382904052734 11.50191974639893 13.75630378723145 11.13954067230225 13.75630378723145 C 10.77974605560303 13.75630378723145 10.48727130889893 13.46382904052734 10.48727130889893 13.10145092010498 C 10.48727130889893 12.74172210693359 10.77974605560303 12.44918155670166 11.13954067230225 12.44918155670166 Z M 16.3730640411377 13.10145092010498 C 18.18489456176758 13.10145092010498 19.64209747314453 14.5586519241333 19.64209747314453 16.3730640411377 C 19.64209747314453 18.18489456176758 18.18489456176758 19.64209747314453 16.3730640411377 19.64209747314453 C 14.5586519241333 19.64209747314453 13.10145092010498 18.18489456176758 13.10145092010498 16.3730640411377 C 13.10145092010498 14.5586519241333 14.5586519241333 13.10145092010498 16.3730640411377 13.10145092010498 Z M 16.36272811889648 13.74596691131592 C 16.0003490447998 13.75371932983398 15.71304416656494 14.04877853393555 15.71821308135986 14.41115760803223 L 15.71821308135986 16.64228248596191 L 16.88559150695801 17.80959510803223 C 17.04865837097168 17.98041534423828 17.29448509216309 18.05031967163086 17.52228927612305 17.98816871643066 C 17.75002670288086 17.93125152587891 17.93125152587891 17.75002670288086 17.98816871643066 17.52228927612305 C 18.05031967163086 17.29448509216309 17.98041534423828 17.04865837097168 17.80959510803223 16.88559150695801 L 17.02533531188965 16.10133171081543 L 17.02533531188965 14.41115760803223 C 17.02791976928711 14.23516941070557 16.96059799194336 14.0616979598999 16.83377647399902 13.93745994567871 C 16.70953750610352 13.81322193145752 16.53871726989746 13.74338245391846 16.36272811889648 13.74596691131592 Z M 5.908565521240234 15.06342601776123 C 6.270931243896484 15.06342601776123 6.563405513763428 15.35848426818848 6.563405513763428 15.71821308135986 C 6.563405513763428 16.0780086517334 6.270931243896484 16.3730640411377 5.908565521240234 16.3730640411377 C 5.548790454864502 16.3730640411377 5.256316184997559 16.0780086517334 5.256316184997559 15.71821308135986 C 5.256316184997559 15.35848426818848 5.548790454864502 15.06342601776123 5.908565521240234 15.06342601776123 Z M 8.525362014770508 15.06342601776123 C 8.885090827941895 15.06342601776123 9.180214881896973 15.35848426818848 9.180214881896973 15.71821308135986 C 9.180214881896973 16.0780086517334 8.885090827941895 16.3730640411377 8.525362014770508 16.3730640411377 C 8.165566444396973 16.3730640411377 7.870501518249512 16.0780086517334 7.870501518249512 15.71821308135986 C 7.870501518249512 15.35848426818848 8.165566444396973 15.06342601776123 8.525362014770508 15.06342601776123 Z M 11.13954067230225 15.06342601776123 C 11.50191974639893 15.06342601776123 11.79439449310303 15.35848426818848 11.79439449310303 15.71821308135986 C 11.79439449310303 16.0780086517334 11.50191974639893 16.3730640411377 11.13954067230225 16.3730640411377 C 10.77974605560303 16.3730640411377 10.48727130889893 16.0780086517334 10.48727130889893 15.71821308135986 C 10.48727130889893 15.35848426818848 10.77974605560303 15.06342601776123 11.13954067230225 15.06342601776123 Z" fill="#858585" stroke="none" stroke-width="1" stroke-miterlimit="4" stroke-linecap="butt" /></svg>',
                      allowDrawingOutsideViewBox: true,
                      fit: BoxFit.fill,
                      color: pageIndex == 1 ? HexColor('33BEA3') : Colors.grey,
                    ),
                  ),
                  Padding(
                    padding: const EdgeInsets.all(3.0),
                    child: Text(
                      'Appointment',
                      style: TextStyle(
                        fontFamily: 'Arial',
                        fontSize: 10,
                        color:
                            pageIndex == 1 ? HexColor('33BEA3') : Colors.grey,
                      ),
                      textAlign: TextAlign.left,
                    ),
                  )
                ],
              ),
            ),
          ),
          GestureDetector(
            onTap: () {
              setState(() {
                pageIndex = 2;
              });
            },
            child: Container(
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  Container(
                    height: 20,
                    width: 25,
                    child: Pinned.fromPins(
                      Pin(start: 0.0, end: 0.0),
                      Pin(start: 0.0, end: 0.0),
                      child: SvgPicture.string(
                        '<svg viewBox="0.0 0.0 24.9 16.0" ><path transform="translate(-0.99, -5.92)" d="M 2.353575229644775 5.921879768371582 L 12.37508010864258 15.27131843566895 C 12.96628284454346 15.82729816436768 13.89871120452881 15.82729816436768 14.48639965057373 15.27131843566895 L 24.51142883300781 5.921879768371582 L 2.353575229644775 5.921879768371582 Z M 0.9882810115814209 7.076043128967285 L 0.9882810115814209 20.66563987731934 L 8.015302658081055 13.63860034942627 L 0.9882810115814209 7.076043128967285 Z M 25.8766975402832 7.076043128967285 L 18.84965705871582 13.63860034942627 L 25.8766975402832 20.66563987731934 L 25.8766975402832 7.076043128967285 Z M 9.313767433166504 14.85253238677979 L 2.244487047195435 21.92181968688965 L 24.62051773071289 21.92181968688965 L 17.54771423339844 14.85253238677979 L 15.70384502410889 16.5732593536377 C 15.0634593963623 17.16797256469727 14.24705410003662 17.46352958679199 13.43074035644531 17.46352958679199 C 12.61433601379395 17.46352958679199 11.79802227020264 17.16797256469727 11.15754508972168 16.5732593536377 L 9.313767433166504 14.85253238677979 Z" fill="#6b0772" stroke="none" stroke-width="1" stroke-miterlimit="4" stroke-linecap="butt" /></svg>',
                        allowDrawingOutsideViewBox: true,
                        color:
                            pageIndex == 2 ? HexColor('33BEA3') : Colors.grey,
                        fit: BoxFit.fill,
                      ),
                    ),
                  ),
                  Padding(
                    padding: const EdgeInsets.all(3.0),
                    child: Text(
                      'Chats',
                      style: TextStyle(
                        fontFamily: 'Arial',
                        fontSize: 10,
                        color:
                            pageIndex == 2 ? HexColor('33BEA3') : Colors.grey,
                      ),
                      textAlign: TextAlign.left,
                    ),
                  )
                ],
              ),
            ),
          ),
          GestureDetector(
            onTap: () {
              setState(() {
                pageIndex = 3;
              });
            },
            child: Container(
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  Container(
                    height: 25,
                    width: 25,
                    child: SvgPicture.string(
                      '<svg viewBox="1.0 0.0 17.0 17.6" ><path  d="M 9.5 0 C 6.086114406585693 0 3.318181753158569 2.633127212524414 3.318181753158569 5.880748271942139 C 3.318181753158569 9.128391265869141 6.086114406585693 11.76149654388428 9.5 11.76149654388428 C 12.91390800476074 11.76149654388428 15.68181896209717 9.128391265869141 15.68181896209717 5.880748271942139 C 15.68181896209717 2.633127212524414 12.91390800476074 0 9.5 0 Z M 5.370738983154297 7.833376884460449 L 13.62930011749268 7.833376884460449 C 12.86862754821777 9.280555725097656 11.31714630126953 10.29130935668945 9.5 10.29130935668945 C 7.682885646820068 10.29130935668945 6.131395816802979 9.280555725097656 5.370738983154297 7.833376884460449 Z M 5.926136493682861 12.77225017547607 C 3.626067161560059 13.34657859802246 1.827057719230652 14.71333789825439 1 17.64224433898926 L 18.00000190734863 17.64224433898926 C 17.17295074462891 14.71333789825439 15.37396430969238 13.34657859802246 13.0738639831543 12.77225017547607 C 12.00835037231445 13.31497001647949 10.7919225692749 13.62223815917969 9.5 13.62223815917969 C 8.208077430725098 13.62223815917969 6.991658210754395 13.31497001647949 5.926136493682861 12.77225017547607 Z" fill="#858585" stroke="none" stroke-width="1" stroke-miterlimit="4" stroke-linecap="butt" /></svg>',
                      allowDrawingOutsideViewBox: true,
                      fit: BoxFit.fill,
                      color: pageIndex == 3 ? HexColor('33BEA3') : Colors.grey,
                    ),
                  ),
                  Padding(
                    padding: const EdgeInsets.all(3.0),
                    child: Text(
                      'Profile',
                      style: TextStyle(
                        fontFamily: 'Arial',
                        fontSize: 10,
                        color:
                            pageIndex == 3 ? HexColor('33BEA3') : Colors.grey,
                      ),
                      textAlign: TextAlign.left,
                    ),
                  )
                ],
              ),
            ),
          ),
        ],
      ),
    );
  }
}
